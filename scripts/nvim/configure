#!/bin/bash -e

INIT_VIM=$HOME/.config/nvim/init.vim
NVIM_CONFIG=$HOME/.config/nvim

if [ ! -e "$NVIM_CONFIG" ]; then
    mkdir -p $NVIM_CONFIG
fi

if [ ! -f "~/.local/share/nvim/site/autoload/plug.vim"  ]; then
    curl -fLo ~/.local/share/nvim/site/autoload/plug.vim --create-dirs \
        https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
fi

if [ ! -f $NVIM_CONFIG/lua  ]; then
    curl -fLo ~/.local/share/nvim/site/autoload/plug.vim --create-dirs \
        https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
fi

ln -s $DOTFILES/nvim/init.vim $NVIM_CONFIG/init.vim
ln -s $DOTFILES/nvim/init.vim $NVIM_CONFIG/lua/init.lua
ln -s $DOTFILES/nvim/init.vim $NVIM_CONFIG/lua/editor.lua
ln -s $DOTFILES/nvim/init.vim $NVIM_CONFIG/lua/lsp.lua

# Install neovim lsp
./scripts/nvim/nightly-update

# Install python lsp
pip install --user jedi-language-server
python3 -m venv ~/.config/nvim/venv
~/.config/nvim/venv/bin/pip install -U pip
~/.config/nvim/venv/bin/pip install pynvim

# Install bash lsp
npm i -g bash-language-server

# Install docker lsp
npm install -g dockerfile-language-server-nodejs

# Instal vim lsp
npm install -g vim-language-server

# Install yaml language server
npm install -g yaml-language-server

# nvim +PlugInstall +qall # TODO check why generate error reading from input
